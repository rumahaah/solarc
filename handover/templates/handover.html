{% extends "base_psapca.html" %}{% load widget_tweaks %}{% load ho_extras %}{% load humanize %}{% load l10n %}{% block title %}Handover | SolArc{% endblock %}
{% block filter %}{% endblock %}
{% block content %}
<div class="uk-container">
    <table class="table2excel uk-table uk-table-divider uk-table-hover uk-table-small" style="font-size: 70%;">
    <!-- <table class="uk-table uk-text-small uk-table-small uk-table-divider"> -->
    <!-- <caption>PSA {{ list.count }}</caption> -->
        <thead>
            <tr>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">No</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Customer Name</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Project Name</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">SA</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">PSS</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Sales</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">PO Date</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">PO Known Date</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Submit Project Charter PMOIS Date</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Submit Presales HO PMOIS Date</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Preproject Progress</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Problem Category</th>
                <th class="uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">TCV</th>
                {% if request.user.is_staff %}<th class="noExl uk-table-middle" style="font-size: 100%; color: #404040; font-weight: bold;">Edit</th>{% endif %}
            </tr>
            <tr>
                <form method="get" class="">
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle">{% render_field list.form.pca__psa__preproject__oppty__customer__customer_name class="uk-input uk-form-width-xsmall uk-form-small" %}</th>
                    <th class="uk-table-middle">{% render_field list.form.pca__psa__preproject__oppty__project_name class="uk-input uk-form-width-xsmall uk-form-small" %}</th>
                    <th class="uk-table-middle">{% render_field list.form.pca__psa__preproject__sa_lintasarta__name class="uk-input uk-form-width-xsmall uk-form-small" %}</th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"><select name="problem_category" class="uk-select uk-form-small" id="id_problem_category" style="width: 35px;font-size: 80%;">
                      <option value=""></option>
                      <option value="n-pr" {%if request.GET.problem_category == 'n-pr'%} selected {%endif%}>Fulfilled</option>
                      <option value="e-sc" {%if request.GET.problem_category == 'e-sc'%} selected {%endif%}>E - Scope Change</option>
                      <option value="e-rn" {%if request.GET.problem_category == 'e-rn'%} selected {%endif%}>E - Renewal Process</option>
                      <option value="e-po" {%if request.GET.problem_category == 'e-po'%} selected {%endif%}>E - Conduct PSA After PO</option>
                      <option value="e-pr" {%if request.GET.problem_category == 'e-pr'%} selected {%endif%}>E - Custom Product</option>
                      <option value="i-pc" {%if request.GET.problem_category == 'i-pc'%} selected {%endif%}>I - PCA Form</option>
                      <option value="i-de" {%if request.GET.problem_category == 'i-de'%} selected {%endif%}>I - Delay to HO</option>
                    </select></th>
                    <!-- <th class="uk-table-middle">{% render_field list.form.problem_category class="uk-select uk-form-width-xsmall uk-form-small" %}</th> -->
                    <th class="uk-table-middle"></th>
                    <th class="uk-table-middle"></th>
                    <button type="submit" hidden="">Search</button>
                </form>
            </tr>
        </thead>
        <tbody>{% for ho in list.qs %} 
            <tr> 
            	<td>{{ forloop.counter }}</td>
                <td>{% for customer in ho.pca.psa.preproject.customer.all %}{{ customer.customer_name }}{% endfor %}</td> 
                <td>{{ho.pca.psa.preproject.project_name}}</td> 
                <td>{% for sa in ho.pca.psa.preproject.sa_lintasarta.all %}<span uk-tooltip="title:{{sa.initial}}; delay:250">{{sa.name}}</span>{% endfor %}</td>
                <td>{% for pss in ho.pca.psa.preproject.pss_lintasarta.all %}<span uk-tooltip="title:{{pss.name}}; delay:250">{{ pss.initial }}</span>{% endfor %}</td> 
                <td><span uk-tooltip="title:{{ho.pca.psa.preproject.sales_lintasarta.name}}; delay:250">{{ho.pca.psa.preproject.sales_lintasarta.initial}}</span></td>
            	<td>{{ho.po_date}}</td> 
            	<td>{{ho.po_known_date}}</td> 
                <td>{{ho.submit_doc_projectcharter_date}}</td> 
                <td>{{ho.submit_presales_handover_date}}</td> 
                <td>{% if ho.pca.psa.preproject.progress == 'w' %}Close Won{% elif ho.pca.psa.preproject.progress == 'l' %}Close Lost{% elif ho.pca.psa.preproject.progress == 'p' %}Progress - Internal SA{% elif ho.pca.psa.preproject.progress == 's' %}Progress - Submited{% elif ho.pca.psa.preproject.progress == 'c' %}Cacncelled{% else %}PSA NOTGO/HOLD{%endif%}</td> 
                <!-- <td>{{ho.problem_category}}</td>  -->
                <td>{% if ho.problem_category == 'n-pr' %}No Problem - Fulfilled{% elif ho.problem_category == 'e-sc'%}External - Scope Change{% elif ho.problem_category == 'e-rn'%}External - Renewal Process{% elif ho.problem_category == 'e-po'%}External - Conduct PSA After PO{% elif ho.problem_category == 'e-pr'%}External - Custom Product{% elif ho.problem_category == 'i-pc'%}Internal - PCA Form{% elif ho.problem_category == 'i-de'%}Internal - Delay to HO{% else %}TES{% endif %}</td>
                <td>{% rupiah ho.pca.tcv %}</td>
                {% if request.user.is_staff %}<td class="noExl"><a href="/admin/handover/handover/{{ho.id}}/change/" target="_blank" class="uk-link-reset" uk-icon="icon:file-edit; ratio:0.8"></a></td>{% endif %} 
            </tr>
        </tbody>{% endfor %}
    </table>
    <button class="exportToExcel uk-button uk-button-small uk-button-primary">Export to XLS</button>
</div>
{% endblock %}
{% block scriptexportexcel %}filename: "Export Handover" + ".xls",{% endblock %}
